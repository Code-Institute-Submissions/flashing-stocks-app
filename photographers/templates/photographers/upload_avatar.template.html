{% extends 'base.template.html' %}
{% load static %}

{% block extrajs %}
<script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>
{% endblock %}

{% block content %}
<!-- <button id="upload_widget" class="cloudinary-button">Upload files</button> -->

<form id="upload_avatar_form" method="POST">
    {% csrf_token %}
    {{ form }}
    <!-- <input type="hidden" id="avatar_url" /> -->
    <button type="submit">Change</button>
</form>

<hr />


<img src="{{ avatar_url.image.url }}" width="320" id="avatar_img">


{% endblock %}


{% block postloadjs %}
    <script type="text/javascript">  

        let img_url = ""
        
        var myWidget = cloudinary.createUploadWidget({
            cloudName: 'dplac6tdu',
            upload_preset: 'vbygwu8t',
            }, (error, result) => { if (result.event == "success") {
                //console.log(result.info)
                console.log(result.info.url)
         
                img_url = result.info.url
                document.getElementById("avatar_img").src= img_url
     
            } })

            document.getElementById("upload_widget").addEventListener("click", function(){
                myWidget.open();
            }, false);

            

    </script>
{% endblock %}